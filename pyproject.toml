[tool.poetry]
name = "rfmix-reader"
version = "0.2.0"  # This will be overridden if dynamic versioning is enabled
description = "RFMix-reader is a Python package designed to efficiently read and process output files generated by RFMix, a popular tool for estimating local ancestry in admixed populations. The package employs a lazy loading approach, which minimizes memory consumption by reading only the loci that are accessed by the user, rather than loading the entire dataset into memory at once."
authors = ["Kynon J.M. Benjamin <kj.benjamin90@gmail.com>"]
maintainers = ["Kynon J.M. Benjamin <kj.benjamin90@gmail.com>"]
readme = "README.md"
license = "GPL-3.0-or-later"
keywords = ["file parser", "rfmix", "gpu acceleration", "local ancestry"]
homepage = "https://rfmix-reader.readthedocs.io/en/latest/"
repository = "https://github.com/heart-gen/rfmix_reader.git"
packages = [{ include = "rfmix_reader" }]
classifiers = [
  "Programming Language :: Python :: 3",
  "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
  "Operating System :: OS Independent"
]

[tool.poetry.dependencies]
python = ">=3.10"
numpy = ">=2.0"
pandas = ">=2.0"
dask = ">=2025.1"
tqdm = ">=4.66"
cyvcf2 = "^0.31.1"
zarr = ">=2.0"
psutil = "^7.0.0"
matplotlib = "^3.10.1"
seaborn = "^0.13.2"
cairosvg = "^2.7.1"
torch = ">=2.6"
torchvision = ">=0.21"

[tool.poetry.extras]
gpu = ["cupy", "cudf", "dask-cudf"]
io = ["pyarrow"]  # parquet export
docs = ["sphinx", "sphinx-rtd-theme", "sphinx-autodoc-typehints"]
tests = ["pytest"]

[tool.poetry.scripts]
create-binaries = "rfmix_reader._cli:main"

[tool.poetry.group.test.dependencies]
pytest = "^8.2"

[tool.poetry.group.docs.dependencies]
sphinx = "^7.3.7"
sphinx-rtd-theme = "^2.0.0"
sphinx-autodoc-typehints = "^2.1.0"

[[tool.poetry.source]]
name = "pytorch_cpu"
url = "https://download.pytorch.org/whl/cpu"
priority = "explicit"

[tool.poetry-dynamic-versioning]
enable = true
write_to = "rfmix_reader/_version.py"

[build-system]
requires = ["poetry-core>=2.0.0", "poetry-dynamic-versioning"]
build-backend = "poetry_dynamic_versioning.backend"
